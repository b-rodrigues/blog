{
  "hash": "746d4330d31447ae8f66a7be05263023",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Using R as a Computer Algebra System with Ryacas\"\ndate: \"2013-12-31\"\ncategories:\n  - R\n  - econometrics\ntoc: true\n---\n\n\n\n<!-- MathJax scripts -->\n<script type=\"text/javascript\" async\n  src=\"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML\">\n</script>\n\n\n</head>\n\n<body>\n<p>R is used to perform statistical analysis and doesn&#39;t focus on symbolic maths. But it is sometimes useful to let the computer derive a function for you (and have the analytic expression of said derivative), but maybe you don&#39;t want to leave your comfy R shell. It is possible to turn R into a full-fledged computer algebra system. CASs are tools that perform symbolic operations, such as getting the expression of the derivative of a user-defined (and thus completely arbitrary) function. Popular CASs include the proprietary Mathematica and Maple. There exists a lot of CASs under a Free Software license, Maxima (based on the very old Macsyma), Yacas, Xcas&hellip; In this post I will focus on Yacas and the <code>Ryacas</code> libarary. There is also the possibility to use the <code>rSympy</code> library that uses the <code>Sympy</code> Python library, which has a lot more features than Yacas. However, depending on your operating system installation can be tricky as it also requires <code>rJava</code> as a dependency. </p>\n\n<p>Even though <code>Ryacas</code> is quite nice to have, there are some issues though. For example, let&#39;s say you want the first derivative of a certain function f. If you use <code>Ryacas</code> to get it, the returned object won&#39;t be a function. There is a way to &ldquo;extract&rdquo; the text from the returned object and make a function out of it. But there are still other issues; I&#39;ll discuss them later.</p>\n\n<h2>Installation</h2>\n\n<p>Installation should be rather painless. On Linux you need to install Yacas first, which should be available in the major distros&#39; repositories. Then you can install <code>Ryacas</code> from within the R shell. On Windows, you need to run these three commands (don&#39;t bother installing Yacas first):</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(Ryacas)\nlibrary(Ryacas)\nyacasInstall()\n```\n:::\n\n\n\n<p>You can find more information on the <a href=\"https://code.google.com/p/ryacas/#INSTALLATION\">project&#39;s page</a>.</p>\n\n<h2>Example session</h2>\n\n<p>First, you must load <code>Ryacas</code> and define symbols that you will use in your functions.</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Ryacas)\n```\n:::\n\n\n\n<pre><code>## Loading required package: Ryacas Loading required package: XML\n</code></pre>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- Sym(\"x\")\n```\n:::\n\n\n\n<p>You can then define your fonctions:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_func <- function(x) {\n  return(x/(x^2 + 3))\n}\n```\n:::\n\n\n\n<p>And you can get the derivative for instance:</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_deriv <- yacas(deriv(my_func(x), x))\n```\n:::\n\n\n\n<pre><code>## [1] \"Starting Yacas!\"\n</code></pre>\n\n<p>If you check the class of <code>my_deriv</code>, you&#39;ll see that it is of class <code>yacas</code>, which is not very useful. Let&#39;s «convert» it to a function:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_deriv2 <- function(x) {\n  eval(parse(text = my_deriv$YacasForm))\n}\n```\n:::\n\n\n\n<p>We can then evaluate it. A lot of different operations are possible. But there are some problems.</p>\n\n<h2>Issues with Ryacas</h2>\n\n<p>You can&#39;t use elements of a vector as parameters of your function, i.e.:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheta <- Sym(\"theta\")\nfunc <- function(x) {\n  return(theta[1] * x + theta[2])\n}\n```\n:::\n\n\n\n# Let&#39;s integrate this\nFunc <- yacas(Integrate(func(x), x))\n</code></pre>\n\n<p>returns <code>(x^2*theta)/2+NA*x;</code> which is not quite what we want&hellip;there is a workaround however. Define your functions like this:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- Sym(\"a\")\nb <- Sym(\"b\")\nfunc2 <- function(x) {\n  return(a * x + b)\n}\n\n# Let&#39;s integrate this\nFunc2 <- yacas(Integrate(func2(x), x))\n```\n:::\n\n\n\n<p>we get the expected result: <code>(x^2*a)/2+b*x;</code>. Now replace <code>a</code> and <code>b</code> by the thetas:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFunc2 <- gsub(\"a\", \"theta[1]\", Func2$YacasForm)\nFunc2 <- gsub(\"b\", \"theta[2]\", Func2)\n```\n:::\n\n\n\n<p>Now we have what we want: </p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFunc2\n```\n:::\n\n\n\n<pre><code>## [1] \"(x^2*theta[1])/2+theta[2]*x;\"\n</code></pre>\n\n<p>You can then copy-paste this result into a function.</p>\n\n<p>Another problem is if you use built-in functions that are different between R and Yacas. For example:</p>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_log <- function(x) {\n    return(sin(log(2 + x)))\n}\n```\n:::\n\n\n\n<p>Now try to differentiate it:</p>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndmy_log <- yacas(deriv(my_log(x), x))\n```\n:::\n\n\n\n<p>you get: <code>Cos(Ln(x+2))/(x+2);</code>. The problem with this, is that R doesn&#39;t recognize <code>Cos</code> as the cosine (which is <code>cos</code> in R) and the same goes for <code>Ln</code>. These are valid Yacas functions, but that is not the case in R. So you&#39;ll have to use <code>gsub</code> to replace these functions and then copy paste the end result into a function.</p>\n\n<h2>Conclusion</h2>\n\n<p>While it has some flaws, <code>Ryacas</code> can be quite useful if you need to derive or integrate complicated expressions that you then want to use in R. Using some of the tricks I showed here, you should be able to overcome some of its shortcomings. If installation of <code>rJava</code> and thus <code>rSympy</code> becomes easier, I&#39;ll probably also do a short blog-post about it, as it has more features than <code>Ryacas</code>.</p>\n\n</body>\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}