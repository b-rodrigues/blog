{
  "hash": "0e18aed8a6bac90fc275419e3dce30a3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"What would a keyboard optimised for Luxembourgish look like? Now with an actual keyboard!\"\nauthor: \"Bruno Rodrigues\"\ndate: \"2025-12-31\"\ncategories: [R, keyboard]\n---\n\n\n\n<div style=\"text-align: center;\">\n  <p>\n    <a>\n      <img src=\"../assets/img/qwertz-lux.png\" style=\"width: 100%; height: auto;\">\n    </a>\n  </p>\n</div>\n\n\n\n\n\n\n\n\n## An optimised layout for a polyglot country\n\n[5 years ago](https://brodrigues.co/posts/2020-03-26-bepo_lu.html) I\ndiscussed what features a keyboard optimised for Luxembourg should have. I'm\ntalking about Luxembourg the country, and not Luxembourgish the language,\nbecause in Luxembourg no one types only Luxembourgish. The most commonly typed language\nis probably French, and English a close second. German follows in third and then\nLuxembourgish (some people might argue that, in their own experience, German\nis more widely typed than French, but I seriously doubt it). Whatever the actual ranking,\nan optimised keyboard for Luxembourg should be a keyboard in which typing these\n4 languages is comfortable. That blog post from 5 years ago dug into that (letter frequency\nand so on), but until today, I left it on the back burner.\n\nNow, with LLMs it was trivial to continue working on this, implement\nan effort model, and use an optimisation algorithm to minimise said effort.\nToday, I can present the layout I've obtained:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2025-12-31-qwertz-lux_files/figure-html/heatmap-qwertz-lux-intro-1.png){width=768}\n:::\n:::\n\n\n\n(there is an error in the layout shown here, there are two \"G\"s; the one\non the right of E should not be there, and instead should be a \",\". This\nis a bug in the function that creates the heatmap, not in the layout itself.)\n\n> ⚠️ **This is a work in progress!** The layout, the name, and even the\n> methodology are all open for discussion. I'm sharing this early because I'd\n> love to hear from the community, especially those who type in multiple\n> languages daily. Your feedback will shape the final version.\n\nLet me also clarify what my goal with this is: do I want to actually suggest\na layout that shall be adopted nationally and become a standard? Well, maybe.\nBut I definitely won't do it alone. So if you're interested, we could work\ntogether and write a layout that could actually be used by different operating\nsystems and pitch it to decision makers.\n\n## France Shows the Way\n\nIn 2019, France officially adopted two new keyboard standards:\n\n1. **A revised AZERTY** that fixes many issues while maintaining familiarity\n2. **BÉPO** — a completely redesigned layout optimised for French\n\nI've been using BÉPO for years, and I can honestly say it's a game-changer.\nTyping feels more natural, there's less finger movement, and the learning curve,\nwhile steep at first, pays off significantly.\n\nBut here's the thing: BÉPO was designed primarily for French. Luxembourg is\nunique, because we need something that works for French *and* German *and*\nLuxembourgish *and* English.\n\n## The QWERTZ-LUX Approach\n\nSo I started wondering: what would an optimised keyboard layout for Luxembourg\nlook like? You can read about my findings\n[here](https://brodrigues.co/posts/2020-03-26-bepo_lu.html), but basically,\nany optimised layout for any of these 4 languages would actually work rather\nwell; this is because 3 out of these 4 languages are Germanic languages, but\nalso, the top 10 most used characters for these 4 languages are essentially the\nsame.\n\nSo I had three options:\n\n1. Simply propose that we also adopt BÉPO\n2. Create a fully optimised layout using these 4 languages for setting up the\n   optimisation problem\n3. Keep QWERTZ as a base for familiarity and only move around a minimal set of\n  characters to improve comfort.\n\nI chose a middle path, inspired by Carpalx's [partial\noptimization](https://mk.bcgsc.ca/carpalx/?partial_optimization) philosophy.\nMartin Krzywinski demonstrated that you don't need to remap the entire keyboard\nto reap most of the rewards. Just 5 strategic key swaps can achieve **70% of the\neffort reduction** of a fully optimised layout, while the learning curve remains\nmanageable.\n\nQWERTZ-LUX (final name pending) follows this principle. It's essentially a fork\nof BÉPO's structure, but with modifications that:\n\n- Keep familiar elements for QWERTZ users (Ctrl+Z, Ctrl+X, Ctrl+C, Ctrl+V shortcuts)\n- Optimize the letter arrangement for our multilingual corpus\n- Provide direct access to accented characters (é, à, ü, ö, ç, ä) without dead keys\n\nThe home row had to change substantially, because QWERTZ's home row is simply\ntoo inefficient. But I tried to minimize disruption elsewhere, following the\npartial optimization insight that the first few key swaps matter most. Setting\nup the optimisation problem with these constraints resulted in a keyboard layout\nthat stays familiar, while being much more efficient.\n\n## The Corpus: What Does Luxembourg Type?\n\nTo evaluate keyboard layouts fairly, we need text that reflects what people actually\ntype in Luxembourg. I created a balanced multilingual corpus with:\n\n- **30% French** — Administrative and business language\n- **30% English** — International communication\n- **20% German** — Media and education\n- **20% Luxembourgish** — Daily life and national identity\n\nAgain, your mileage may vary. When I first started working in Luxembourg, I only\nused English and French. Now I also use Luxembourgish more often, and I know\npeople who only write French. Either way, a national keyboard layout should be\nable to be comfortable for any of these languages.\n\n\n\n\n\n\n\nWhat actually matters is the top letters across all languages, which are **E,\nN, S, T, R, I, A**, the letters you'd want on your home row.\n\n## The Effort Model Explained\n\nBefore comparing layouts, let's understand how we measure \"typing effort\". I\nwrote an R package called **lbkeyboard** that implements a model inspired by\n[Carpalx](https://mk.bcgsc.ca/carpalx/?typing_effort), the seminal keyboard\nlayout optimization tool created by Martin Krzywinski.\n\n### Carpalx vs lbkeyboard\n\n| Aspect | Carpalx | lbkeyboard |\n|--------|---------|------------|\n| **Unit of analysis** | Triads (3-key sequences) | Bigrams + individual keys |\n| **Base effort** | Finger travel distance | Position-based (row + column) |\n| **Penalties** | Hand, row, finger costs | Same-finger, same-hand, row-change |\n| **Stroke path** | Complex path penalties | Simplified via bigram weights |\n| **Layer support** | Not built-in | Shift, AltGr, dead key penalties |\n\nCarpalx uses triads and a sophisticated stroke path model. I simplify this to\nbigrams (2-key sequences) for faster computation while retaining the key\nergonomic insights.\n\n### Our Model Components\n\n### 1. Base Effort (Weight: 3.0)\n\nEvery key has an inherent effort based on position. Home row keys (where fingers\nrest) have the lowest effort; reaching up to the top row or down to the bottom\nrow costs more. Finger strength matters too: index fingers are stronger than\npinkies.\n\n**Example**: Typing \"e\" on QWERTZ (top row, middle finger reach) costs more than\ntyping \"j\" (home row, index finger)—even though we use \"e\" 100× more often!\n\n### 2. Same-Finger Bigram Penalty (Weight: 3.0)\n\nUsing the same finger twice in a row is slow and uncomfortable. The model\nheavily penalizes these sequences.\n\n**Example**: Typing \"de\" on QWERTZ uses the same finger (middle finger, D→E).\nThis is penalized. On BÉPO, these letters are on different hands, so no penalty.\n\n### 3. Same-Hand Penalty (Weight: 0.5)\n\nConsecutive keys on the same hand are slightly harder than alternating hands,\nbecause one hand must do all the work.\n\n### 4. Row Change Penalty (Weight: 0.5)\n\nJumping between rows (e.g., top→bottom) requires more finger travel than staying\non the same row.\n\n### 5. Layer Penalties\n\nCharacters requiring modifier keys (Shift, AltGr, dead keys) incur extra effort:\n- **Shift**: +5% effort\n- **AltGr**: +20% effort\n- **Dead key** (e.g., ˆ + o = ô): +40% effort (two keystrokes!)\n\n### Putting It Together\n\nThe total effort formula is:\n\n```\nTotal = Σ (base × frequency) + Σ (same_finger_penalty) + Σ (same_hand_penalty)\n        + Σ (row_change_penalty) + Σ (layer_penalties)\n```\n\n**Numerical Example**: Consider typing \"the\" (one of the most common English trigrams):\n\n| Layout | Key Positions | Same-Finger? | Row Changes | Effort |\n|--------|--------------|--------------|-------------|--------|\n| QWERTZ | T(top), H(home), E(top) | No | 2 | Moderate |\n| BÉPO   | T(home), H(bottom), E(home) | No | 1 | **Low** |\n\nBÉPO places two letters on the home row, and two characters are typed using\nindex finger (T and E), so it's very comfortable to type.\n\n### A Concrete Example: The Pangram\n\nLet's calculate actual effort scores for \"the quick brown fox jumps over the\nlazy dog\" (a pangram using every letter of the alphabet):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load layouts\ndata(\"ch_qwertz\")\ndata(\"afnor_bepo\")\nqwertz_lux <- create_qwertz_lux_keyboard()\n\n# Effort weights (same as used throughout)\neffort_weights <- list(\n  base = 3.0,\n  same_finger = 3.0,\n  same_hand = 0.5,\n  row_change = 0.5,\n  trigram = 0.3\n)\n\npangram <- \"the quick brown fox jumps over the lazy dog\"\n\n# Calculate effort for each layout\npangram_qwertz <- calculate_layout_effort(ch_qwertz, pangram, \n                                          keys_to_evaluate = letters,\n                                          effort_weights = effort_weights)\npangram_bepo <- calculate_layout_effort(afnor_bepo, pangram,\n                                        keys_to_evaluate = letters,\n                                        effort_weights = effort_weights)\npangram_lux <- calculate_layout_effort(qwertz_lux$base, pangram,\n                                       keys_to_evaluate = letters,\n                                       effort_weights = effort_weights)\n\ndata.frame(\n  Layout = c(\"QWERTZ\", \"BÉPO\", \"QWERTZ-LUX\"),\n  Effort = round(c(pangram_qwertz, pangram_bepo, pangram_lux), 2),\n  `vs QWERTZ` = paste0(round((1 - c(pangram_qwertz, pangram_bepo, pangram_lux) / \n                               pangram_qwertz) * 100, 1), \"%\"),\n  check.names = FALSE\n)\n#>       Layout Effort vs QWERTZ\n#> 1     QWERTZ 338.69        0%\n#> 2       BÉPO 268.79     20.6%\n#> 3 QWERTZ-LUX 303.08     10.5%\n```\n:::\n\n\n\nEven for this short 35-letter sentence, the optimised layouts require measurably less effort.\n\n## How Much Better Is It?\n\nUsing this effort model (with the weights shown above), here's how the layouts compare:\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_on88mmpg0ou10w1hfvrg(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_on88mmpg0ou10w1hfvrg\");\n          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_on88mmpg0ou10w1hfvrg');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_on88mmpg0ou10w1hfvrg(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_on88mmpg0ou10w1hfvrg\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: 3, j: 0 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 3 }, { i: 3, j: 4 },  ], css_id: 'tinytable_css_q738uiagwmrnj98zlysu',}, \n          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_3zqx25g8iiiymlzocot4',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_on88mmpg0ou10w1hfvrg(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_q738uiagwmrnj98zlysu, .table th.tinytable_css_q738uiagwmrnj98zlysu { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_3zqx25g8iiiymlzocot4, .table th.tinytable_css_3zqx25g8iiiymlzocot4 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_on88mmpg0ou10w1hfvrg\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\">Layout</th>\n                <th scope=\"col\">Effort Score</th>\n                <th scope=\"col\">Hand Balance (L/R %)</th>\n                <th scope=\"col\">Relative (%)</th>\n                <th scope=\"col\">Improvement vs QWERTZ</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>BÉPO          </td>\n                  <td> 633624.9</td>\n                  <td>43.6/56.4</td>\n                  <td>100.0</td>\n                  <td>42.1%</td>\n                </tr>\n                <tr>\n                  <td>QWERTZ-LUX    </td>\n                  <td> 642547.9</td>\n                  <td>52.1/47.9</td>\n                  <td>101.4</td>\n                  <td>41.3%</td>\n                </tr>\n                <tr>\n                  <td>QWERTZ (Swiss)</td>\n                  <td>1094468.2</td>\n                  <td>59/41    </td>\n                  <td>172.7</td>\n                  <td>0%   </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n## Visualizing the Difference: Heatmaps\n\nHeatmaps show where your fingers spend time. Brighter colors = more keystrokes.\nIdeally, you want the brightness concentrated on the home row.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2025-12-31-qwertz-lux_files/figure-html/heatmaps-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](2025-12-31-qwertz-lux_files/figure-html/heatmap-qwertz-lux-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](2025-12-31-qwertz-lux_files/figure-html/heatmap-bepo-1.png){width=768}\n:::\n:::\n\n\n\nNotice how BÉPO and QWERTZ-LUX concentrate activity on the home row, while\nQWERTZ spreads effort across all rows.\n\n### Key Features\n\n| Feature | Benefit |\n|---------|---------|\n| **Optimized home row** | High-frequency letters (E, T, N, R, I, S) within easy reach |\n| **Direct accents** | é, à, ü, ö, ç, ä accessible without dead key combinations |\n| **ZXCV preserved** | Common shortcuts (Ctrl+Z/X/C/V) stay in familiar positions |\n| **BÉPO-compatible** | Same modifier layer philosophy as BÉPO |\n\n\n## What's Next?\n\nSo I'd like to know what others think. Is this something you'd be\ninterested in exploring further? The next step would be to write a `layout.ini`\nfile for *Portable Keyboard Layout* for Windows, and write layout files for\nLinux and macOS, and have real people test it in real-world settings.\nWe could see if it feels comfortable and what else could be optimised.\n\nBut is there a chance that such a layout will ever get adopted? After all, there\nare obstacles:\n\n- People just don't care and won't ever switch\n- Even if people cared, Luxembourg is too small a market and keyboards will never\n  ship with a Luxembourg-specific layout\n\nIn my opinion, rolling out such a keyboard would require a phased and gradual approach:\n\n- Have kids learn to touch type in school on the optimised layout\n- Distribute keyboard layout stickers, which are cheap\n\nAfter some years, the switch would be complete, so I think it's feasible, but\nonly if there is a community around this layout. Also, who knows, this layout\ncould technically be adopted in Switzerland and other German-speaking nations\n(maybe as a variant without direct access to French accented letters).\n\n## About the Name\n\nThe current working name \"QWERTZ-LUX\" is descriptive but not final. The first\nletters of the layout are **QWFOG**, which doesn't exactly roll off the tongue\nlike \"QWERTY\" or \"BÉPO.\" Here are some alternatives I'm considering:\n\n| Name | Meaning |\n|------|---------|\n| **QWERTZ-LUX** | Current name; descriptive (QWERTZ variant for Luxembourg) |\n| **LÉTZ** | Short for *Lëtzebuergesch* (Luxembourgish); catchy and culturally meaningful |\n| **LUXO** | Luxembourg Optimized |\n| **TRIGLOT** | Reflects the trilingual focus (French, German, Luxembourgish) |\n\nWhat do you think? I'm genuinely open to suggestions: a good name helps adoption!\n\nOh, and happy new year I guess.",
    "supporting": [
      "2025-12-31-qwertz-lux_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}